# Integration
> This section records the main part of the study which is how the story pulls down to the target

* [Package version](#package-version)
* [Identification of active enhancers](#identification-of-active-enhancers)
    + [Input and Output](#input-and-output)
    + [Command](#command)
    + [Result](#result)
* [Accessibility of regulatory elements](#accessibility-of-regulatory-elements)
    + [Input and Output](#input-and-output)
    + [Command](#command)
    + [Result](#result)
* [Methylation correlated with accessibility](#Methylation-correlated-with-accessibility)
    + [Input and Output](#input-and-output)
    + [Command](#command)
    + [Result](#result)
* [Reference](#reference)

## Package version
`tidyverse v1.3.1`


## Identification of active enhancers

We want to pull the list of regulatory element from the whole database to THP-1 cell specific. So we combine H3K27ac marker with enhancer to identify THP-1 active enhancers. However, there isn't any H3K27ac ChIP seq for 24 hour 100ng/ml PMA THP-1 cells so we only included 5 replicates of untreated THP-1 cell ChIP-seq results.

### Input and Output

* Input file
  - Genhancer interaction file
    - Collected the Double Elite file from UCSC browser to provide confident
  - H3K27ac marker from ChIP-atlas
    - GSM3514953; GSM3514952; GSM2544236; GSM2544237; GSM4083810
  - List of DEGs from section 4
* Output file
  - List of active enhancers for DEGs in THP-1 cells
  - List of active enhancers in THP-1 cells
  - H3K27ac marker in untreated THP-1 cells

### Command

```sh
# merging all bed files from ChIP-atlas into one file
cat $.bed > H3K27ac_temp1.bed
sort -k1,1 -k2,2n H3K27ac_temp1.bed > H3K27ac_temp2.bed
bedtools merge -i H3K27ac_temp2.bed > H3K27ac.bed
rm H3K27ac_temp1.bed H3K27ac_temp2.bed
```

```R
# Identification of enhancers for DEGs
library(tidyverse)

temp <- read.delim("/path/to/GeneInteraction_doubleElite.bed")
# Select enhancers for DEGs
temp <- temp[temp$geneName %in% sig$hgnc_symbol,]
# Remove metadata (Crucial)
temp <- dplyr::select(.data = temp,geneHancerChrom:geneHancerStrand,geneName,geneAssociationMethods)
# Export for bedtools
write_delim(x = temp,file = "DEG_enhancer.txt",delim = "\t",col_names = F)
```

```sh
# Combine the marker with enhancer
bedtools -a DEG_enhancer.txt -b H3K27ac.bed -wa > DEG_active_enhancer.bed
```

### Result



## Accessibility of regulatory elements

### Input and Output

### Command

```R

```

### Result




## Methylation correlated with accessibility

### Input and Output

### Command

```R

```



### Result



## Reference


