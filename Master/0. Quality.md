# Quality control
> The file records all quality control performed during the selection of datasets.

* [Package version](#package-version)
* [Employed dataset](#employed-dataset)
* [Queried dataset](#queried-dataset)
* [Reference](#reference)

## Package version
`fastqc v0.11.9`
`multiqc v1.14`


## Employed dataset

The following figure shows the quality of all fastq file that were incoporated during the study. This study includes RNA-seq, ATAC-seq and WGBS for 0 hour (untreat) and 24 hour 100ng/ml (~162nM) PMA treated THP-1 cells. The dataset are recorded under PRJNA533829 / GSE130096.

```R
library(tidyverse)

x =  read_tsv("./Input/fastqc_per_base_sequence_quality_plot.tsv")
# Following steps rename all column using accession number which is the first phrase separate by "_"
z = colnames(x)
z = as.data.frame(do.call('rbind', strsplit(as.character(z),'_',fixed=TRUE)))   # Isolating the phrases
colnames(x) = paste0(z$V1)                                                      # Changing the column names to accession number
# This code combines the column with same accession number (R1 and R2) and value is the mean
x = as.data.frame(lapply(split(seq_len(ncol(x)),colnames(x)),function(cis) rowMeans(x[cis])))
# Convert to long dataframe
z = x %>% gather(key = "variable",value = "value",-Position..bp.)
# Plot
ggplot(z,aes(x = Position..bp.,y=value)) +
  geom_line(aes(color = variable)) +
  ylim(0,40)+
  xlab("Position in read(bp)") +
  ylab("Phred Score") +
  theme_bw()
```

<br />
<p align="center">
  <img width="460" height="300" src="https://github.com/Yifan-bio/msc/blob/8580c17de235bce9403d6e215b2cba4cb634416f/Master/Image/Figure%200.1.A.png">
  <img width="460" height="300" src="https://github.com/Yifan-bio/msc/blob/8580c17de235bce9403d6e215b2cba4cb634416f/Master/Image/Figure%200.1.B.png">
</p>

_**Figure 3.1. All employed datasets present qualified sequencing quality.** The graph separately represents a) the per base sequencing quality and b) the mean sequence quality of all reads. All sequencing libraries were derived from 100 ng/ml PMA treated and untreated THP-1 cells collected from PRJNA53382. Expected contamination were found for both ATAC-seq library and WGBS library._

<br />

WGBS and ATAC-seq has shown to suffer to the technique specific quality challenges which was accounted for during the processing of dataset. This bias includes high adapter sequencing rate and high duplication rate introudced by Tn5 tranposase during library extraction. 

## Queried dataset

Other datasets such as PRJNA379744 were also evaluated but shows to suffer with a none human source DNA contamination.

## Reference

