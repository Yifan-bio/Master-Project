# Quality control
> The file records all quality control performed during the selection of datasets.

* [Package version](#package-version)
* [Employed dataset](#employed-dataset)
* [Queried dataset](#queried-dataset)
* [Reference](#reference)

## Package version
`fastqc v0.11.9`
`multiqc v1.14`


## Employed dataset

The following figure shows the quality of all fastq file that were incoporated during the study. This study includes RNA-seq, ATAC-seq and WGBS for 0 hour (untreat) and 24 hour 100ng/ml (~162nM) PMA treated THP-1 cells. The dataset are recorded under PRJNA533829 / GSE130096.

```R
library(tidyverse)

# Per base quality
temp =  read_tsv("./Input/fastqc_per_base_sequence_quality_plot.tsv")
# Renaming the files
colnames(temp) = c("Pos",paste0("ATAC",1:8),paste0("WGBS",1:4),paste0("RNA",1:8))
# Convert to long dataframe
temp = temp %>% gather(key = "variable",value = "value",-Pos)
# Allowing all same tech to be in one colour
temp$colour = gsub('[[:digit:]]+', '',temp$variable)
temp=na.omit(temp)
# Plot
plot1 = ggplot(temp,aes(x = Pos,y=value),) +
        geom_line(aes(group = variable,color = colour),show.legend = FALSE) +
        scale_x_continuous(limits = c(0,150),expand = c(0,0)) +
        scale_y_continuous(limits = c(0,41),expand = c(0,0)) +
        xlab("Position in read(bp)") +
        ylab("Phred Score") +
        theme_bw() +
        scale_color_manual(values = c("#1f88b4","#ff7f0e","#2ca02c"))

# Per sequence quality
temp = read_tsv("./Input/fastqc_per_sequence_quality_scores_plot.tsv")
# Renaming the files
colnames(temp) = c("Score",paste0("ATAC",1:8),paste0("WGBS",1:4),paste0("RNA",1:8))
# Convert to long dataframe
temp = temp %>% gather(key = "variable",value = "value",-Score)
temp$colour = gsub('[[:digit:]]+', '',temp$variable)

plot2 = ggplot(temp,aes(x = Score,y=value)) +
        geom_line(aes(group = variable,color = colour),show.legend = FALSE) +
        scale_x_continuous(limits = c(0,40),expand = c(0,0)) +
        scale_y_continuous(limits = c(0,150000000),expand = c(0,0)) +
        xlab("Phred Score") +
        ylab("Number of reads") +
        theme_bw() +
        scale_color_manual(values = c("#1f88b4","#ff7f0e","#2ca02c"))

ggpubr::ggarrange(plot1,plot2)
ggsave(dpi=900,"fastqc.png")
```

<br />
<p align="center">
  <img width="460" height="300" src="https://github.com/Yifan-bio/msc/blob/8580c17de235bce9403d6e215b2cba4cb634416f/Master/Image/Figure%200.1.A.png">
  <img width="460" height="300" src="https://github.com/Yifan-bio/msc/blob/8580c17de235bce9403d6e215b2cba4cb634416f/Master/Image/Figure%200.1.B.png">
</p>

_**Figure 3.1. All employed datasets present qualified sequencing quality.** The graph separately represents a) the per base sequencing quality and b) the mean sequence quality of all reads. All sequencing libraries were derived from 100 ng/ml PMA treated and untreated THP-1 cells collected from PRJNA53382. Expected contamination were found for both ATAC-seq library and WGBS library._

<br />

WGBS and ATAC-seq has shown to suffer to the technique specific quality challenges which was accounted for during the processing of dataset. This bias includes high adapter sequencing rate and high duplication rate introudced by Tn5 tranposase during library extraction. 

## Queried dataset

Other datasets such as PRJNA379744 were also evaluated but shows to suffer with a none human source DNA contamination.

## Reference

